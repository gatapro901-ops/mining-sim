<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ø£Ø¬Ù‡Ø²ØªÙƒ</title>
<style>
body { font-family: Arial; background:#222; color:#fff; text-align:center; }
.container { max-width:800px; margin:auto; }
.item-box { background:#333; padding:15px; margin:15px 0; border-radius:8px; }
button { padding:8px 12px; border:none; border-radius:5px; cursor:pointer; margin:5px; }
button.start { background:green; color:white; }
button.start:hover { background:#2ecc71; }
button.stop { background:red; color:white; }
button.stop:hover { background:#e74c3c; }
a { color:#1abc9c; text-decoration:none; }
a:hover { text-decoration:underline; }

/* ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */
#msg-box {
    display:none;
    padding:12px;
    margin:15px auto;
    width:90%;
    border-radius:8px;
    text-align:center;
    font-size:18px;
    font-weight:bold;
}

.msg-on  { background:#2ecc71; color:#fff; }
.msg-off { background:#e74c3c; color:#fff; }
</style>
</head>
<body>

<h2>Ø£Ø¬Ù‡Ø²ØªÙƒ</h2>
<a href="{{ url_for('dashboard') }}">ğŸ  Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯</a>

<div id="msg-box"></div>

<div class="container">
    {% for item in items %}
    <div class="item-box" id="item-{{ item.id }}">
        <h3>{{ item.name }}</h3>
        <p>Ø§Ù„Ø¥Ù†ØªØ§Ø¬: {{ item.sat_per_cycle }} Ø³Ø§ØªÙˆØ´ÙŠ ÙƒÙ„ {{ item.interval }} Ø«Ø§Ù†ÙŠØ©</p>

        <!-- Ø²Ø± ØªØ´ØºÙŠÙ„/Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¬Ù‡Ø§Ø² -->
        <button id="power-{{ item.id }}"
            class="{{ 'stop' if item.power_on else 'start' }}"
            onclick="togglePower('{{ item.id }}')">
            {{ 'Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¬Ù‡Ø§Ø²' if item.power_on else 'ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¬Ù‡Ø§Ø²' }}
        </button>
    </div>
    {% endfor %}
</div>

<script>
function togglePower(itemId) {
    fetch(`/toggle_power/${itemId}`)
    .then(res => res.json())
    .then(data => {
        const box = document.getElementById("msg-box");
        box.innerText = data.message;
        box.classList.remove("msg-on","msg-off");
        box.classList.add(data.active ? "msg-on" : "msg-off");
        box.style.display = "block";
        setTimeout(() => { box.style.display = "none"; }, 3000);

        const btn = document.getElementById(`power-${itemId}`);
        if (data.active) {
            btn.classList.remove('start');
            btn.classList.add('stop');
            btn.innerText = 'Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¬Ù‡Ø§Ø²';
        } else {
            btn.classList.remove('stop');
            btn.classList.add('start');
            btn.innerText = 'ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¬Ù‡Ø§Ø²';
        }
    });
}
</script>

</body>
</html>